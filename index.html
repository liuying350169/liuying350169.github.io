<html>

<head>
    <script src="https://d3js.org/d3.v4.min.js"></script>

</head>

<body>
    <div id="chart">
        <svg></svg>
    </div>
    <script>
        //这里跟echarts／jquery是一样的，要选中一个div里的svg。用id选，或id+标签
        var svg = d3.select('#chart svg')
            // svg
            //     .append('circle')
            //     .attr('cx', 50)
            //     .attr('cy', 50)
            //     .attr('r', 50)
        var data = [{
            Country: "A",
            GDP: 200,
            Life: 60,
            Population: 50
        }, {
            Country: "B",
            GDP: 50,
            Life: 60,
            Population: 100
        }, {
            Country: "C",
            GDP: 70,
            Life: 80,
            Population: 50
        }]

        var data2 = [{
            Country: "A",
            GDP: 100,
            Life: 20,
            Population: 50
        }, {
            Country: "B",
            GDP: 110,
            Life: 70,
            Population: 30
        }, {
            Country: "D",
            GDP: 150,
            Life: 80,
            Population: 30
        }]

        function updateChart(data) {
            var circles = svg
                //选中所有的视觉元素
                .selectAll('circle')
                //选中所有的数据点
                .data(data, function(d, i) {
                    return d['Country']
                })
            circles
            //找到每一个新数据点
                .enter()
                //新加一个视觉元素circle
                .append('circle')
                //找到现在所有的数据点
                .merge(circles)
                //改变状态他们的状态，加一个transition，就会自动加动画
                .transition()
                .attr('r', 10)
                .attr('cx', function(d, i) {
                    //console.log(d) 发现出来的是data object
                    //console.log(i) 发现出来的是data的index
                    return d['GDP']
                })
                .attr('cy', function(d, i) {
                    return d['Life']
                })
            circles
            //每执行完一次，从数据集里拿掉
                .exit()
                //退出之前，加个效果，变白色
                .transition()
                .style('fill', 'rgba(0,0,0,0')
                //监听事件，当出现end事件的时候，把视觉元素也remove掉
                .on('end', function() {
                    d3.select(this).remove()
                })

        }
        updateChart(data)
        setTimeout(function() {
            updateChart(data2)
        }, 3000)
    </script>
</body>

</html>
